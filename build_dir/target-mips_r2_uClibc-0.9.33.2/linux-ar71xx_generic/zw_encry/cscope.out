cscope 15 $HOME/zhongwang/trunk/package/kernel/zw_encry/src               0000040247
	@sha256.h

1 #i‚de‡
_SHA256_H


2 
	#_SHA256_H


	)

4 
	tuch¨
;

5 
	tuöt
;

16 
	s°r_cmd
{

17 
uch¨
 
	mcou¡
;

18 
uch¨
 
	md©a
[39];

19 
uöt
 
	m¸c
;

20 }
	tcmd_buff
;

23 #i‚de‡
uöt8


24 
	#uöt8
 

	)

27 #i‚de‡
uöt32


28 
	#uöt32
 

	)

33 
uöt32
 
	mtŸÆ
[2];

34 
uöt32
 
	m°©e
[8];

35 
uöt8
 
	mbuf„r
[64];

37 
	tsha256_c⁄ãxt
;

39 
sha256_°¨ts
–
sha256_c⁄ãxt
 *
˘x
 );

40 
sha256_upd©e
–
sha256_c⁄ãxt
 *
˘x
, 
uöt8
 *
öput
, 
uöt32
 
Àngth
 );

41 
sha256_föish
–
sha256_c⁄ãxt
 *
˘x
, 
uöt8
 
dige°
[32] );

43 
	#GET_UINT32
(
n
,
b
,
i
) \

45 (
n
Ë–(
uöt32
Ë(
b
)[(
i
) ] << 24 ) \

46 | ( (
uöt32
Ë(
b
)[(
i
) + 1] << 16 ) \

47 | ( (
uöt32
Ë(
b
)[(
i
) + 2] << 8 ) \

48 | ( (
uöt32
Ë(
b
)[(
i
) + 3] ); \

49 }

	)

51 
	#PUT_UINT32
(
n
,
b
,
i
) \

53 (
b
)[(
i
Ë] = (
uöt8
Ë–(
n
) >> 24 ); \

54 (
b
)[(
i
Ë+ 1] = (
uöt8
Ë–(
n
) >> 16 ); \

55 (
b
)[(
i
Ë+ 2] = (
uöt8
Ë–(
n
) >> 8 ); \

56 (
b
)[(
i
Ë+ 3] = (
uöt8
Ë–(
n
) ); \

57 }

	)

59 
	$sha256_°¨ts
–
sha256_c⁄ãxt
 *
˘x
 )

61 
˘x
->
tŸÆ
[0] = 0;

62 
˘x
->
tŸÆ
[1] = 0;

64 
˘x
->
°©e
[0] = 0x6A09E667;

65 
˘x
->
°©e
[1] = 0xBB67AE85;

66 
˘x
->
°©e
[2] = 0x3C6EF372;

67 
˘x
->
°©e
[3] = 0xA54FF53A;

68 
˘x
->
°©e
[4] = 0x510E527F;

69 
˘x
->
°©e
[5] = 0x9B05688C;

70 
˘x
->
°©e
[6] = 0x1F83D9AB;

71 
˘x
->
°©e
[7] = 0x5BE0CD19;

72 
	}
}

74 
	$sha256_¥o˚ss
–
sha256_c⁄ãxt
 *
˘x
, 
uöt8
 
d©a
[64] )

76 
uöt32
 
ãmp1
, 
ãmp2
, 
W
[64];

77 
uöt32
 
A
, 
B
, 
C
, 
D
, 
E
, 
F
, 
G
, 
H
;

79 
	`GET_UINT32
–
W
[0], 
d©a
, 0 );

80 
	`GET_UINT32
–
W
[1], 
d©a
, 4 );

81 
	`GET_UINT32
–
W
[2], 
d©a
, 8 );

82 
	`GET_UINT32
–
W
[3], 
d©a
, 12 );

83 
	`GET_UINT32
–
W
[4], 
d©a
, 16 );

84 
	`GET_UINT32
–
W
[5], 
d©a
, 20 );

85 
	`GET_UINT32
–
W
[6], 
d©a
, 24 );

86 
	`GET_UINT32
–
W
[7], 
d©a
, 28 );

87 
	`GET_UINT32
–
W
[8], 
d©a
, 32 );

88 
	`GET_UINT32
–
W
[9], 
d©a
, 36 );

89 
	`GET_UINT32
–
W
[10], 
d©a
, 40 );

90 
	`GET_UINT32
–
W
[11], 
d©a
, 44 );

91 
	`GET_UINT32
–
W
[12], 
d©a
, 48 );

92 
	`GET_UINT32
–
W
[13], 
d©a
, 52 );

93 
	`GET_UINT32
–
W
[14], 
d©a
, 56 );

94 
	`GET_UINT32
–
W
[15], 
d©a
, 60 );

96 
	#SHR
(
x
,
n
Ë((x & 0xFFFFFFFFË>>Ç)

	)

97 
	#ROTR
(
x
,
n
Ë(
	`SHR
(x,nË| (x << (32 -Ç)))

	)

99 
	#S0
(
x
Ë(
	`ROTR
(x, 7Ë^ ROTR(x,18Ë^ 
	`SHR
(x, 3))

	)

100 
	#S1
(
x
Ë(
	`ROTR
(x,17Ë^ ROTR(x,19Ë^ 
	`SHR
(x,10))

	)

102 
	#S2
(
x
Ë(
	`ROTR
(x, 2Ë^ ROTR(x,13Ë^ ROTR(x,22))

	)

103 
	#S3
(
x
Ë(
	`ROTR
(x, 6Ë^ ROTR(x,11Ë^ ROTR(x,25))

	)

105 
	#F0
(
x
,
y
,
z
Ë((x & yË| (z & (x | y)))

	)

106 
	#F1
(
x
,
y
,
z
Ë(z ^ (x & (y ^ z)))

	)

108 
	#R
(
t
) \

110 
W
[
t
] = 
	`S1
(W[t - 2]) + W[t - 7] + \

111 
	`S0
(
W
[
t
 - 15]) + W[t - 16] \

112 )

	)

114 
	#P
(
a
,
b
,
c
,
d
,
e
,
f
,
g
,
h
,
x
,
K
) \

116 
ãmp1
 = 
h
 + 
	`S3
(
e
Ë+ 
	`F1
”,
f
,
g
Ë+ 
K
 + 
x
; \

117 
ãmp2
 = 
	`S2
(
a
Ë+ 
	`F0
◊,
b
,
c
); \

118 
d
 +
ãmp1
; 
h
 =Åemp1 + 
ãmp2
; \

119 }

	)

121 
A
 = 
˘x
->
°©e
[0];

122 
B
 = 
˘x
->
°©e
[1];

123 
C
 = 
˘x
->
°©e
[2];

124 
D
 = 
˘x
->
°©e
[3];

125 
E
 = 
˘x
->
°©e
[4];

126 
F
 = 
˘x
->
°©e
[5];

127 
G
 = 
˘x
->
°©e
[6];

128 
H
 = 
˘x
->
°©e
[7];

130 
	`P
–
A
, 
B
, 
C
, 
D
, 
E
, 
F
, 
G
, 
H
, 
W
[ 0], 0x428A2F98 );

131 
	`P
–
H
, 
A
, 
B
, 
C
, 
D
, 
E
, 
F
, 
G
, 
W
[ 1], 0x71374491 );

132 
	`P
–
G
, 
H
, 
A
, 
B
, 
C
, 
D
, 
E
, 
F
, 
W
[ 2], 0xB5C0FBCF );

133 
	`P
–
F
, 
G
, 
H
, 
A
, 
B
, 
C
, 
D
, 
E
, 
W
[ 3], 0xE9B5DBA5 );

134 
	`P
–
E
, 
F
, 
G
, 
H
, 
A
, 
B
, 
C
, 
D
, 
W
[ 4], 0x3956C25B );

135 
	`P
–
D
, 
E
, 
F
, 
G
, 
H
, 
A
, 
B
, 
C
, 
W
[ 5], 0x59F111F1 );

136 
	`P
–
C
, 
D
, 
E
, 
F
, 
G
, 
H
, 
A
, 
B
, 
W
[ 6], 0x923F82A4 );

137 
	`P
–
B
, 
C
, 
D
, 
E
, 
F
, 
G
, 
H
, 
A
, 
W
[ 7], 0xAB1C5ED5 );

138 
	`P
–
A
, 
B
, 
C
, 
D
, 
E
, 
F
, 
G
, 
H
, 
W
[ 8], 0xD807AA98 );

139 
	`P
–
H
, 
A
, 
B
, 
C
, 
D
, 
E
, 
F
, 
G
, 
W
[ 9], 0x12835B01 );

140 
	`P
–
G
, 
H
, 
A
, 
B
, 
C
, 
D
, 
E
, 
F
, 
W
[10], 0x243185BE );

141 
	`P
–
F
, 
G
, 
H
, 
A
, 
B
, 
C
, 
D
, 
E
, 
W
[11], 0x550C7DC3 );

142 
	`P
–
E
, 
F
, 
G
, 
H
, 
A
, 
B
, 
C
, 
D
, 
W
[12], 0x72BE5D74 );

143 
	`P
–
D
, 
E
, 
F
, 
G
, 
H
, 
A
, 
B
, 
C
, 
W
[13], 0x80DEB1FE );

144 
	`P
–
C
, 
D
, 
E
, 
F
, 
G
, 
H
, 
A
, 
B
, 
W
[14], 0x9BDC06A7 );

145 
	`P
–
B
, 
C
, 
D
, 
E
, 
F
, 
G
, 
H
, 
A
, 
W
[15], 0xC19BF174 );

146 
	`P
–
A
, 
B
, 
C
, 
D
, 
E
, 
F
, 
G
, 
H
, 
	`R
(16), 0xE49B69C1 );

147 
	`P
–
H
, 
A
, 
B
, 
C
, 
D
, 
E
, 
F
, 
G
, 
	`R
(17), 0xEFBE4786 );

148 
	`P
–
G
, 
H
, 
A
, 
B
, 
C
, 
D
, 
E
, 
F
, 
	`R
(18), 0x0FC19DC6 );

149 
	`P
–
F
, 
G
, 
H
, 
A
, 
B
, 
C
, 
D
, 
E
, 
	`R
(19), 0x240CA1CC );

150 
	`P
–
E
, 
F
, 
G
, 
H
, 
A
, 
B
, 
C
, 
D
, 
	`R
(20), 0x2DE92C6F );

151 
	`P
–
D
, 
E
, 
F
, 
G
, 
H
, 
A
, 
B
, 
C
, 
	`R
(21), 0x4A7484AA );

152 
	`P
–
C
, 
D
, 
E
, 
F
, 
G
, 
H
, 
A
, 
B
, 
	`R
(22), 0x5CB0A9DC );

153 
	`P
–
B
, 
C
, 
D
, 
E
, 
F
, 
G
, 
H
, 
A
, 
	`R
(23), 0x76F988DA );

154 
	`P
–
A
, 
B
, 
C
, 
D
, 
E
, 
F
, 
G
, 
H
, 
	`R
(24), 0x983E5152 );

155 
	`P
–
H
, 
A
, 
B
, 
C
, 
D
, 
E
, 
F
, 
G
, 
	`R
(25), 0xA831C66D );

156 
	`P
–
G
, 
H
, 
A
, 
B
, 
C
, 
D
, 
E
, 
F
, 
	`R
(26), 0xB00327C8 );

157 
	`P
–
F
, 
G
, 
H
, 
A
, 
B
, 
C
, 
D
, 
E
, 
	`R
(27), 0xBF597FC7 );

158 
	`P
–
E
, 
F
, 
G
, 
H
, 
A
, 
B
, 
C
, 
D
, 
	`R
(28), 0xC6E00BF3 );

159 
	`P
–
D
, 
E
, 
F
, 
G
, 
H
, 
A
, 
B
, 
C
, 
	`R
(29), 0xD5A79147 );

160 
	`P
–
C
, 
D
, 
E
, 
F
, 
G
, 
H
, 
A
, 
B
, 
	`R
(30), 0x06CA6351 );

161 
	`P
–
B
, 
C
, 
D
, 
E
, 
F
, 
G
, 
H
, 
A
, 
	`R
(31), 0x14292967 );

162 
	`P
–
A
, 
B
, 
C
, 
D
, 
E
, 
F
, 
G
, 
H
, 
	`R
(32), 0x27B70A85 );

163 
	`P
–
H
, 
A
, 
B
, 
C
, 
D
, 
E
, 
F
, 
G
, 
	`R
(33), 0x2E1B2138 );

164 
	`P
–
G
, 
H
, 
A
, 
B
, 
C
, 
D
, 
E
, 
F
, 
	`R
(34), 0x4D2C6DFC );

165 
	`P
–
F
, 
G
, 
H
, 
A
, 
B
, 
C
, 
D
, 
E
, 
	`R
(35), 0x53380D13 );

166 
	`P
–
E
, 
F
, 
G
, 
H
, 
A
, 
B
, 
C
, 
D
, 
	`R
(36), 0x650A7354 );

167 
	`P
–
D
, 
E
, 
F
, 
G
, 
H
, 
A
, 
B
, 
C
, 
	`R
(37), 0x766A0ABB );

168 
	`P
–
C
, 
D
, 
E
, 
F
, 
G
, 
H
, 
A
, 
B
, 
	`R
(38), 0x81C2C92E );

169 
	`P
–
B
, 
C
, 
D
, 
E
, 
F
, 
G
, 
H
, 
A
, 
	`R
(39), 0x92722C85 );

170 
	`P
–
A
, 
B
, 
C
, 
D
, 
E
, 
F
, 
G
, 
H
, 
	`R
(40), 0xA2BFE8A1 );

171 
	`P
–
H
, 
A
, 
B
, 
C
, 
D
, 
E
, 
F
, 
G
, 
	`R
(41), 0xA81A664B );

172 
	`P
–
G
, 
H
, 
A
, 
B
, 
C
, 
D
, 
E
, 
F
, 
	`R
(42), 0xC24B8B70 );

173 
	`P
–
F
, 
G
, 
H
, 
A
, 
B
, 
C
, 
D
, 
E
, 
	`R
(43), 0xC76C51A3 );

174 
	`P
–
E
, 
F
, 
G
, 
H
, 
A
, 
B
, 
C
, 
D
, 
	`R
(44), 0xD192E819 );

175 
	`P
–
D
, 
E
, 
F
, 
G
, 
H
, 
A
, 
B
, 
C
, 
	`R
(45), 0xD6990624 );

176 
	`P
–
C
, 
D
, 
E
, 
F
, 
G
, 
H
, 
A
, 
B
, 
	`R
(46), 0xF40E3585 );

177 
	`P
–
B
, 
C
, 
D
, 
E
, 
F
, 
G
, 
H
, 
A
, 
	`R
(47), 0x106AA070 );

178 
	`P
–
A
, 
B
, 
C
, 
D
, 
E
, 
F
, 
G
, 
H
, 
	`R
(48), 0x19A4C116 );

179 
	`P
–
H
, 
A
, 
B
, 
C
, 
D
, 
E
, 
F
, 
G
, 
	`R
(49), 0x1E376C08 );

180 
	`P
–
G
, 
H
, 
A
, 
B
, 
C
, 
D
, 
E
, 
F
, 
	`R
(50), 0x2748774C );

181 
	`P
–
F
, 
G
, 
H
, 
A
, 
B
, 
C
, 
D
, 
E
, 
	`R
(51), 0x34B0BCB5 );

182 
	`P
–
E
, 
F
, 
G
, 
H
, 
A
, 
B
, 
C
, 
D
, 
	`R
(52), 0x391C0CB3 );

183 
	`P
–
D
, 
E
, 
F
, 
G
, 
H
, 
A
, 
B
, 
C
, 
	`R
(53), 0x4ED8AA4A );

184 
	`P
–
C
, 
D
, 
E
, 
F
, 
G
, 
H
, 
A
, 
B
, 
	`R
(54), 0x5B9CCA4F );

185 
	`P
–
B
, 
C
, 
D
, 
E
, 
F
, 
G
, 
H
, 
A
, 
	`R
(55), 0x682E6FF3 );

186 
	`P
–
A
, 
B
, 
C
, 
D
, 
E
, 
F
, 
G
, 
H
, 
	`R
(56), 0x748F82EE );

187 
	`P
–
H
, 
A
, 
B
, 
C
, 
D
, 
E
, 
F
, 
G
, 
	`R
(57), 0x78A5636F );

188 
	`P
–
G
, 
H
, 
A
, 
B
, 
C
, 
D
, 
E
, 
F
, 
	`R
(58), 0x84C87814 );

189 
	`P
–
F
, 
G
, 
H
, 
A
, 
B
, 
C
, 
D
, 
E
, 
	`R
(59), 0x8CC70208 );

190 
	`P
–
E
, 
F
, 
G
, 
H
, 
A
, 
B
, 
C
, 
D
, 
	`R
(60), 0x90BEFFFA );

191 
	`P
–
D
, 
E
, 
F
, 
G
, 
H
, 
A
, 
B
, 
C
, 
	`R
(61), 0xA4506CEB );

192 
	`P
–
C
, 
D
, 
E
, 
F
, 
G
, 
H
, 
A
, 
B
, 
	`R
(62), 0xBEF9A3F7 );

193 
	`P
–
B
, 
C
, 
D
, 
E
, 
F
, 
G
, 
H
, 
A
, 
	`R
(63), 0xC67178F2 );

195 
˘x
->
°©e
[0] +
A
;

196 
˘x
->
°©e
[1] +
B
;

197 
˘x
->
°©e
[2] +
C
;

198 
˘x
->
°©e
[3] +
D
;

199 
˘x
->
°©e
[4] +
E
;

200 
˘x
->
°©e
[5] +
F
;

201 
˘x
->
°©e
[6] +
G
;

202 
˘x
->
°©e
[7] +
H
;

203 
	}
}

205 
	$sha256_upd©e
–
sha256_c⁄ãxt
 *
˘x
, 
uöt8
 *
öput
, 
uöt32
 
Àngth
 )

207 
uöt32
 
À·
, 
fûl
;

209 if–! 
Àngth
 ) ;

211 
À·
 = 
˘x
->
tŸÆ
[0] & 0x3F;

212 
fûl
 = 64 - 
À·
;

214 
˘x
->
tŸÆ
[0] +
Àngth
;

215 
˘x
->
tŸÆ
[0] &= 0xFFFFFFFF;

217 if–
˘x
->
tŸÆ
[0] < 
Àngth
 )

218 
˘x
->
tŸÆ
[1]++;

220 if–
À·
 && 
Àngth
 >
fûl
 )

222 
	`mem˝y
–(*Ë(
˘x
->
buf„r
 + 
À·
),

223 (*Ë
öput
, 
fûl
 );

224 
	`sha256_¥o˚ss
–
˘x
, ctx->
buf„r
 );

225 
Àngth
 -
fûl
;

226 
öput
 +
fûl
;

227 
À·
 = 0;

230  
Àngth
 >= 64 )

232 
	`sha256_¥o˚ss
–
˘x
, 
öput
 );

233 
Àngth
 -= 64;

234 
öput
 += 64;

237 if–
Àngth
 )

239 
	`mem˝y
–(*Ë(
˘x
->
buf„r
 + 
À·
),

240 (*Ë
öput
, 
Àngth
 );

242 
	}
}

244 
uöt8
 
	gsha256_∑ddög
[64] =

252 
	$sha256_föish
–
sha256_c⁄ãxt
 *
˘x
, 
uöt8
 
dige°
[32] )

254 
uöt32
 
œ°
, 
∑dn
;

255 
uöt32
 
high
, 
low
;

256 
uöt8
 
msgÀn
[8];

258 
high
 = ( 
˘x
->
tŸÆ
[0] >> 29 )

259 | ( 
˘x
->
tŸÆ
[1] << 3 );

260 
low
 = ( 
˘x
->
tŸÆ
[0] << 3 );

262 
	`PUT_UINT32
–
high
, 
msgÀn
, 0 );

263 
	`PUT_UINT32
–
low
, 
msgÀn
, 4 );

265 
œ°
 = 
˘x
->
tŸÆ
[0] & 0x3F;

266 
∑dn
 = ( 
œ°
 < 56 ) ? ( 56 -Üast ) : ( 120 -Üast );

268 
	`sha256_upd©e
–
˘x
, 
sha256_∑ddög
, 
∑dn
 );

269 
	`sha256_upd©e
–
˘x
, 
msgÀn
, 8 );

271 
	`PUT_UINT32
–
˘x
->
°©e
[0], 
dige°
, 0 );

272 
	`PUT_UINT32
–
˘x
->
°©e
[1], 
dige°
, 4 );

273 
	`PUT_UINT32
–
˘x
->
°©e
[2], 
dige°
, 8 );

274 
	`PUT_UINT32
–
˘x
->
°©e
[3], 
dige°
, 12 );

275 
	`PUT_UINT32
–
˘x
->
°©e
[4], 
dige°
, 16 );

276 
	`PUT_UINT32
–
˘x
->
°©e
[5], 
dige°
, 20 );

277 
	`PUT_UINT32
–
˘x
->
°©e
[6], 
dige°
, 24 );

278 
	`PUT_UINT32
–
˘x
->
°©e
[7], 
dige°
, 28 );

279 
	}
}

	@zw_encry.c

8 
	~<löux/öô.h
>

9 
	~<löux/moduÀ.h
>

10 
	~<löux/kmod.h
>

11 
	~<löux/fs.h
>

12 
	~<löux/ty≥s.h
>

13 
	~<löux/gpio.h
>

14 
	~<löux/miscdevi˚.h
>

15 
	~<löux/devi˚.h
>

16 
	~<löux/cdev.h
>

17 
	~<löux/dñay.h
>

18 
	~<löux/kî√l.h
>

19 
	~<löux/øndom.h
>

20 
	~<löux/moduÀ∑øm.h
>

22 
	~<löux/zw_£curôy.h
>

24 
	~"sha256.h
"

26 
	#MAJOR_NUM
 0

27 

	)

28 
	#GPIO_PORT_SEND
 14

	)

30 
	#DEVICE_NAME
 "zw_í¸y"

	)

31 
	#œbñ_£nd
 "í¸y_gpio_£nd"

	)

34 
	#IO_FLAG_COMMAND
 0X77

	)

35 
	#IO_FLAG_TRANSMIT
 0X88

	)

36 
	#IO_FLAG_SLEEP
 0Xcc

	)

45 
	#OPCODE_MAC
 (0x08)

46 

	)

48 
	#OPCODE_READ
 (0x02)

49 
	#OPCODE_BURN_FUSE
 (0x04)

	)

50 
	#OPCODE_GEN_PERS
 (0x20)

	)

51 
	#OPCODE_BURN_SECURE
 (0x10)

	)

52 
	#OPCODE_PAUSE_LONG
 (0x01)

	)

56 
	#DELAY_Twlo
 
	`udñay
(70)

57 
	#DELAY_Twhi
 
	`mdñay
(5)

58 
	#DELAY_TT°¨t
 
	`udñay
(4)

59 
	#DELAY_TF°¨t
 
	`udñay
(6)

60 
	#DELAY_TTzhi
 
	`udñay
(4)

61 
	#DELAY_TFzhi
 
	`udñay
(6)

62 
	#DELAY_TTzlo
 
	`udñay
(4)

63 
	#DELAY_TFzlo
 
	`udñay
(6)

64 
	#DELAY_BITS
 
	`udñay
(40)

65 
	#DELAY_BITC
 
	`udñay
(50)

66 
	#DELAY_TBITOP
 
	`udñay
(35)

67 
	#DELAY_TBITZP
 
	`udñay
(26)

68 
	#TIME_OUT
 50

	)

71 
	#DELAY_EXEC_READ
 1

72 
	#DELAY_EXEC_MAC
 2

73 
	#DELAY_PARSE
 3

74 
	#DELAY_EXEC_FUSE
 4

75 
	#DELAY_EXEC_SECURE
 5

76 
	#DELAY_PERSON
 6

77 

	)

79 
	#deBug
 0

	)

80 #i‡
deBug


81 
	#PRINTK
(...Ë
	`¥ötk
(
__VA_ARGS__
)

	)

83 
	#PRINTK
(...Ë
	`mdñay
(1);
	`udñay
(500)

	)

87 
	gí¸y_gpio_MAJOR
 = 
MAJOR_NUM
;

90 
cdev
 
	gcdev_í¸y_gpio
;

91 
˛ass
 *
	g˛ass_í¸y_gpio
;

95 
uch¨
 
	gkey
[32]={

101 
uch¨
 
	gfu£_key
[8]={

106 
uch¨
 
	gmychÆÀnge
[32];

114 c⁄° 
uch¨
 
	gmsgmode
 = 0x50;

116 c⁄° 
uch¨
 
	gKeyID
[2]={0xff,0xff};

119 
uch¨
 
	gSètusFu£
[3]={

122 
uch¨
 
	gFu£M‰ID
 = 0x77;

125 
uch¨
 
	gFu£SN
[4]={

129 
uch¨
 
	gROMM‰ID
[2]={

133 
uch¨
 
	gROMSN
[2]={

142 
	$¥Ÿe˘_zw_í¸y
()

144 
	`¥ötk
("pzw\n");

145 
	}
}

146 
EXPORT_SYMBOL
(
¥Ÿe˘_zw_í¸y
);

149 
uöt
 
	$¸c16
(
uch¨
 *
buf
,uch¨ 
Àn
)

151 
uöt
 
¸c
 = 0x0000;

152 
uöt
 
i
;

153 
uch¨
 
˙t
,
bô
,
cbô
;

154 
˙t
 = 0; c¡ < 
Àn
; cnt ++)

156 
i
=0x01; i < 0x100; i <<= 1)

158 if(
buf
[
˙t
] & (
uch¨
Ë
i
)
bô
 =0x01;

159 
bô
 = 0x00;

160 if(0x8000 & 
¸c
)
cbô
=0x01;

161 
cbô
 = 0x00;

162 i‡(
bô
 ^ 
cbô
)
¸c
 = ((crc << 1) & 0xffff) ^ 0x8005;

163 
¸c
 = (crc << 1) & 0xffff;

166  
¸c
;

167 
	}
}

170 
	$wakeup
()

172 if(
	`gpio_dúe˘i⁄_ouçut
(
GPIO_PORT_SEND
,1Ë=-
ENOSYS
)

174 
	`¥ötk
("direction outputÉrror!\n");

177 
	`gpio_£t_vÆue
(
GPIO_PORT_SEND
,0);

179 
DELAY_Twlo
;

180 
	`gpio_£t_vÆue
(
GPIO_PORT_SEND
,1);

182 
DELAY_Twhi
;

183 if(
	`gpio_dúe˘i⁄_öput
(
GPIO_PORT_SEND
Ë=-
ENOSYS
)

185 
	`¥ötk
("direction GPIO_PORT_SEND inputÉrror!\n");

188 
	}
}

191 
	$£nd_zîoBô
()

194 
	`gpio_£t_vÆue
(
GPIO_PORT_SEND
,0);

196 
DELAY_TT°¨t
;

197 
	`ndñay
(100);

198 
	`gpio_£t_vÆue
(
GPIO_PORT_SEND
,1);

200 
DELAY_TTzhi
;

201 
	`ndñay
(100);

202 
	`gpio_£t_vÆue
(
GPIO_PORT_SEND
,0);

204 
DELAY_TTzlo
;

205 
	`ndñay
(100);

206 
	`gpio_£t_vÆue
(
GPIO_PORT_SEND
,1);

208 
DELAY_TBITZP
;

210 
	}
}

213 
	$£nd_⁄eBô
()

216 
	`gpio_£t_vÆue
(
GPIO_PORT_SEND
,0);

218 
DELAY_TT°¨t
;

219 
	`ndñay
(100);

220 
	`gpio_£t_vÆue
(
GPIO_PORT_SEND
,1);

222 
DELAY_TBITOP
;

223 
	}
}

226 
	$£nd_⁄eByã
(
uch¨
 
s
)

228 
uch¨
 
i
 ;

230 if(
	`gpio_dúe˘i⁄_ouçut
(
GPIO_PORT_SEND
,1Ë=-
ENOSYS
)

232 
	`¥ötk
("direction GPIO_PROT_SEND outputÉrror!\n");

235 
i
 = 0; i < 8; i++)

237 if(
s
&(1<<
i
))
	`£nd_⁄eBô
();

238 
	`£nd_zîoBô
();

240 if(
	`gpio_dúe˘i⁄_öput
(
GPIO_PORT_SEND
Ë=-
ENOSYS
)

242 
	`¥ötk
("direction GPIO_PORT_SEND inputÉrror!\n");

245 
	}
}

248 
	gtimeout
;

249 
uch¨
 
	gzîo_Êag
;

250 
uch¨
 
	$ª˚ive_⁄eBô
(
uch¨
 *
r
)

253 
timeout
 = 500000;

254 
zîo_Êag
 = 0;

258 if(!
	`gpio_gë_vÆue
(
GPIO_PORT_SEND
));

260 }--
timeout
 > 0);

262 if(
timeout
 <= 0)

264 
	`PRINTK
("receive_oneBit downÉrror1 \n");

268 
timeout
 = 400000;

271 if(
	`gpio_gë_vÆue
(
GPIO_PORT_SEND
))

273 
zîo_Êag
=1;

276 }--
timeout
 > 0);

278 if(
timeout
 <= 0)

280 
	`PRINTK
("receive_oneBit upÉrror2 \n");

283 
timeout
 = 120;

286 if(!
	`gpio_gë_vÆue
(
GPIO_PORT_SEND
)){
zîo_Êag
=0;;}

287 }--
timeout
 > 0);

289 if(0 =
zîo_Êag
)

291 !
	`gpio_gë_vÆue
(
GPIO_PORT_SEND
));

293 if(1 =
zîo_Êag
Ë*
r
=0x01;

294 *
r
=0x00;

296 
	}
}

299 
uch¨
 
	$ª˚ive_⁄eByã
(
uch¨
 *
R
)

301 
uch¨
 
bô
,
byã
=0,
i
;

302 
i
=0;i < 8; i++)

304 if(!
	`ª˚ive_⁄eBô
(&
bô
))

306 
	`PRINTK
("receive_oneByteÅimeoutxÉrror!\n");

309 
byã
 |(
bô
 << 
i
);

311 *
R
 = 
byã
;

313 
	}
}

317 
	$£nd_SLEEP_Êag
()

319 
	`£nd_⁄eByã
(
IO_FLAG_SLEEP
);

320 
	`mdñay
(100);

321 
	}
}

324 
ölöe
 
uch¨
 
	$£nd_cmd
(
cmd_buff
 *
cmd
, 
u32
 
dñay
)

326 
uch¨
 
i
;

327 
cmd
->
cou¡
 = cmd->
d©a
[0];

328 
cmd
->
¸c
 = 
	`¸c16
(&(cmd->
d©a
[0]),(cmd->data[0] -2));

330 
cmd
->
d©a
[cmd->
cou¡
 - 2] = cmd->
¸c
 & 0xff;

331 
cmd
->
d©a
[cmd->
cou¡
 - 1] = (cmd->
¸c
 >> 8) & 0xff;

333 
	`£nd_⁄eByã
(
IO_FLAG_COMMAND
);

335 
i
=0;ò< 
cmd
->
cou¡
;i++)

337 
	`£nd_⁄eByã
(
cmd
->
d©a
[
i
]);

342 
dñay
)

344 1:
	`mdñay
(4);;

345 2:
	`mdñay
(30);
	`udñay
(100);;

346 3:
	`udñay
(100);;

347 4:
	`udñay
(700);;

348 5:
	`mdñay
(36);;

349 6:
	`mdñay
(13);;

353 
	}
}

355 
ölöe
 
uch¨
 
	$£nd_å™smô
(
cmd_buff
 *
ªp
)

357 
uch¨
 
tmp
[40],
i
,
ii
;

358 
	`£nd_⁄eByã
(
IO_FLAG_TRANSMIT
);

359 
	`udñay
(50);

361 
i
 = 1;
ii
=1;

362 !
	`ª˚ive_⁄eByã
(&
tmp
[0])&&(
i
++ < 5));

363 
i
=1;i<
tmp
[0];i++)

365 if(!
	`ª˚ive_⁄eByã
(&
tmp
[
i
]))

367 
	`PRINTK
("data getÉrror \n"); 0;

370 
	`mem˝y
(&(
ªp
->
d©a
[0]),
tmp
,
i
);

371 
	`mdñay
(25);

372 
ªp
->
cou¡
 =Ñï->
d©a
[0];

374 
ªp
->
¸c
 = 
	`¸c16
(&‘ï->
d©a
[0]),(rep->data[0] - 2));

376 if(((
ªp
->
¸c
 & 0xff)!Ùï->
d©a
[ªp->
cou¡
 - 2]) || (((rep->crc >>8)&0xff)!=rep->data[rep->count - 1]))

378 
	`PRINTK
("transmitÑeceiveÉrror crc!\n");

382 
	}
}

384 
uch¨
 
	$ß_¥o˚ss
(
cmd_buff
 *
cmd
,cmd_buf‡*
ªp
, 
u32
 
dñay
)

386 
cmd_buff
 
buf
;

387 if(!
cmd
 || !
ªp
) 0;

389 
	`wakeup
();

391 if(!
	`£nd_å™smô
(&
buf
))

393 
	`PRINTK
("send_transmit1 sa_processÉrror\n");

397 if(!
	`£nd_cmd
(
cmd
, 
dñay
))

399 
	`PRINTK
("send_cmd sa_processÉrror\n");

404 if(!
	`£nd_å™smô
(
ªp
))

406 
	`PRINTK
("send_transmit2 sa_processÉrror\n");

410 
	`£nd_SLEEP_Êag
();

412 
	}
}

415 
uch¨
 
	$ªad_rom
(
u32
 
addr
,
uch¨
 *
buf
)

417 
cmd_buff
 
cmd
,
ªp
;

419 
cmd
.
d©a
[0] = 7;

420 
cmd
.
d©a
[1] = 
OPCODE_READ
;

421 
cmd
.
d©a
[2] = 0x00;

422 
cmd
.
d©a
[3] = 
addr
 & 0xff;

423 
cmd
.
d©a
[4] = (
addr
 >> 8) & 0xff;

425 if(!
	`ß_¥o˚ss
(&
cmd
, &
ªp
, 
DELAY_EXEC_READ
))

427 
	`PRINTK
("sa_processÑead_rom1Érror\n");

430 if(
ªp
.
cou¡
 < 3)

433 
	`PRINTK
("sa_processÑead_rom2Érror\n");

437 
	`mem˝y
(
buf
,&
ªp
.
d©a
[1],‘ï.
cou¡
-3));

438  (
ªp
.
cou¡
-3);

439 
	}
}

441 
uch¨
 
	$ªad_fu£
(
u32
 
addr
, 
uch¨
 *
buf
)

443 
cmd_buff
 
cmd
,
ªp
;

445 
cmd
.
d©a
[0] = 7;

446 
cmd
.
d©a
[1] = 
OPCODE_READ
;

447 
cmd
.
d©a
[2] = 0x01;

448 
cmd
.
d©a
[3] = 
addr
 & 0xff;

449 
cmd
.
d©a
[4] = (
addr
 >> 8) & 0xff;

451 if(!
	`ß_¥o˚ss
(&
cmd
, &
ªp
, 
DELAY_EXEC_READ
))

453 
	`PRINTK
("sa_processÑead_fuse1Érror\n");

456 if(
ªp
.
cou¡
 < 3)

459 
	`PRINTK
("sa_processÑead_fuse2Érror\n");

463 
	`mem˝y
(
buf
,&
ªp
.
d©a
[1],‘ï.
cou¡
-3));

464  (
ªp
.
cou¡
-3);

465 
	}
}

468 
uch¨
 
	$ªad_mac
(
uch¨
 
mode
, 
uöt
 
keyid
,c⁄° uch¨ *
chÆÀnge
,uch¨ *
mac
)

470 
cmd_buff
 
cmd
,
ªp
;

472 
cmd
.
d©a
[0] = 0x27;

473 
cmd
.
d©a
[1] = 
OPCODE_MAC
;

474 
cmd
.
d©a
[2] = 
mode
;

475 
cmd
.
d©a
[3] = 
keyid
 & 0xff;

476 
cmd
.
d©a
[4] = (
keyid
 >> 8) & 0xff;

478 
	`mem˝y
(&
cmd
.
d©a
[5],
chÆÀnge
,32);

480 if(!
	`ß_¥o˚ss
(&
cmd
, &
ªp
, 
DELAY_EXEC_MAC
))

482 
	`PRINTK
("sa_processÑead_mac1Érror\n");

485 if(
ªp
.
cou¡
 < 3)

488 
	`PRINTK
("sa_processÑead_mac2Érror\n");

492 
	`mem˝y
(
mac
,&
ªp
.
d©a
[1],‘ï.
cou¡
-3));

493  (
ªp
.
cou¡
-3);

494 
	}
}

497 
uch¨
 
	$do_mac
(
uch¨
 
mode
, 
uöt
 
keyid
,c⁄° uch¨ * 
chÆÀnge
, c⁄° uch¨ * 
ex≥˘ed
)

499 
uch¨
 
mac
[32];

500 
uch¨
 
Àn
;

501 
uch¨
 
i
;

503 if(!
chÆÀnge
 || !
ex≥˘ed
)

505 
	`PRINTK
("do_macÉrror 1 \n");

509 
Àn
 = 
	`ªad_mac
(
mode
, 
keyid
, 
chÆÀnge
, 
mac
);

510 if(
Àn
 != 32)

512 
	`PRINTK
("do_macÉrror 2 \n");

516 #i‡
deBug


520 
	`¥ötk
("mac: ", 
mac
[
i
]);

521 
i
 = 0; i < 
Àn
; i++)

523 if((
i
 % 8) == 0)

524 
	`¥ötk
("\r\n");

525 
	`¥ötk
("0x%02x, ", 
mac
[
i
]);

527 
	`¥ötk
("\r\n");

530 
i
 = 0; i < 
Àn
; i++)

532 if(
mac
[
i
] !
ex≥˘ed
[i])

534 
	`PRINTK
("crc don't match!\n");

541 
	}
}

547 
uch¨
 
	$ªad_£rül_numbî
(
uch¨
 *
buf
)

549 
uch¨
 
rom
[32];

550 
uch¨
 
fu£
[32];

551 
uch¨
 
Àn
;

553 
Àn
 = 
	`ªad_rom
(0, 
rom
);

554 if(
Àn
 != 4)

556 
	`PRINTK
("read_serial_number 1Érror\n");

559 
Àn
 = 
	`ªad_fu£
(3, 
fu£
);

560 if(
Àn
 != 4)

562 
	`PRINTK
("read_serial_number 2Érror\n");

567 
buf
[0] = 
rom
[2];

568 
buf
[1] = 
rom
[3];

569 
buf
[2] = 
fu£
[0];

570 
buf
[3] = 
fu£
[1];

571 
buf
[4] = 
fu£
[2];

572 
buf
[5] = 
fu£
[3];

575 
	}
}

581 
uch¨
 
	$ªad_m™uÁ˘uª_id
(
uch¨
 *
buf
)

583 
uch¨
 
rom
[32];

584 
uch¨
 
fu£
[32];

585 
uch¨
 
Àn
;

587 
Àn
 = 
	`ªad_rom
(0, 
rom
);

588 if(
Àn
 != 4)

590 
	`PRINTK
("read_manufacture_id 1Érror\n");

594 
Àn
 = 
	`ªad_fu£
(2, 
fu£
);

595 if(
Àn
 != 4)

597 
	`PRINTK
("read_manufacture_id 2Érror\n");

601 
buf
[0] = 
rom
[0];

602 
buf
[1] = 
rom
[1];

603 
buf
[2] = 
fu£
[3];

605 
	}
}

607 
uch¨
 
	$ªad_fu£_°©us
(
uch¨
 *
buf
)

609 
uch¨
 
fu£
[32];

610 
uch¨
 
Àn
;

612 
Àn
 = 
	`ªad_fu£
(2, 
fu£
);

613 if(
Àn
 != 4)

615 
	`PRINTK
("read_fuse_statusÉrror\n");

619 
buf
[0] = 
fu£
[0];

620 
buf
[1] = 
fu£
[1];

621 
buf
[2] = 
fu£
[2];

624 
	}
}

627 
uch¨
 
	gmsg
[88];

628 
uch¨
 
	$ã°_do_auth
()

630 
uch¨
 
ödex
,
i
=0;

631 
uch¨
 
buf
[64],
cou¡
=0;

633 
sha256_c⁄ãxt
 
˘x
;

634 
sha256sum
[32];

640 
cou¡
 = 0;

641 if(
	`ªad_£rül_numbî
(
buf
))

644 
	`¥ötk
("\nÅhe serial_number is:\n");

645 
i
=0;i<6;i++)
	`¥ötk
("0x%02x ",
buf
[i]);

646 
	`¥ötk
("\n");

648 
	`mdñay
(10);

650 
	`mem˝y
(
ROMSN
,
buf
,2);

651 
	`mem˝y
(
Fu£SN
,
buf
+2,4);

654 if(
cou¡
++ > 5)

656 
	`¥ötk
(
KERN_INFO
"error serialÇo. \n");

659 
	`mdñay
(500);

664 
cou¡
 = 0;

665 if(
	`ªad_m™uÁ˘uª_id
(
buf
))

668 
	`¥ötk
("\nÅhe manufacture id is:\n");

669 
i
=0;i<3;i++)
	`¥ötk
("0x%02x ",
buf
[i]);

670 
	`¥ötk
("\n");

672 
	`mdñay
(10);

674 
ROMM‰ID
[0] = 
buf
[0];

675 
ROMM‰ID
[1] = 
buf
[1];

676 
Fu£M‰ID
 = 
buf
[2];

679 if(
cou¡
++ > 5)

681 
	`¥ötk
(
KERN_INFO
"error manufacture id \n");

684 
	`mdñay
(500);

690 
cou¡
 = 0;

691 if(
	`ªad_fu£_°©us
(
buf
))

694 
	`¥ötk
("\nÅhe status is:\n");

695 
i
=0;i<3;i++)
	`¥ötk
("0x%02x ",
buf
[i]);

696 
	`¥ötk
("\n");

698 
	`mdñay
(10);

700 
SètusFu£
[0] = 
buf
[0];

701 
SètusFu£
[1] = 
buf
[1];

702 
SètusFu£
[2] = 
buf
[2];

705 if(
cou¡
++ > 5)

707 
	`¥ötk
(
KERN_INFO
"error status \n");

710 
	`mdñay
(500);

713 
cou¡
=0;count<32;count++)

715 
	`gë_øndom_byãs
(&
ödex
,(
uch¨
));

716 
mychÆÀnge
[
cou¡
] = 
ödex
%255;

718 
msgmode
)

720 0x00:
	`mem£t
(
fu£_key
,0x00,8),mem£t(
SètusFu£
,0x00,3);mem£t(
Fu£SN
,0x00,4);mem£t(
ROMSN
,0x00,2);;

721 0x10:
	`mem£t
(
Fu£SN
,0x00,4);mem£t(
ROMSN
,0x00,2);;

722 0x20:
	`mem£t
(
SètusFu£
,0x00,3);;

726 
	`mem˝y
(
msg
,
key
,32);

727 
	`mem˝y
(
msg
+32,
mychÆÀnge
,32);

728 
msg
[64] = 0x08;

729 
msg
[65] = 
msgmode
;

730 
	`mem˝y
(
msg
+66,
KeyID
,2);

731 
	`mem˝y
(
msg
+68,
fu£_key
,8);

732 
	`mem˝y
(
msg
+76,
SètusFu£
,3);

733 
msg
[79] = 
Fu£M‰ID
;

734 
	`mem˝y
(
msg
+80,
Fu£SN
,4);

735 
	`mem˝y
(
msg
+84,
ROMM‰ID
,2);

736 
	`mem˝y
(
msg
+86,
ROMSN
,2);

738 
i
=0;i<88;i++)

740 
	`¥ötk
("msg[%2d] = %02x ",
i
,
msg
[i]);

741 if((
i
+1)%8==0)
	`¥ötk
("\n");

744 
	`mdñay
(10);

746 
	`sha256_°¨ts
–&
˘x
 );

747 
	`sha256_upd©e
–&
˘x
,
msg
,88);

748 
	`sha256_föish
–&
˘x
, 
sha256sum
);

750 
i
=0;i<32;i++)

752 
	`¥ötk
("0x%02x, ",
sha256sum
[
i
]);

753 if((
i
+1)%8==0)
	`¥ötk
("\n");

755 
	`¥ötk
("\n");

757 
	`mdñay
(10);

759 
cou¡
 = 0;

763 
	`gë_øndom_byãs
(&
ödex
,());

764 
ödex
 = index % 4;

765 
	`PRINTK
("ödex i†%d \n",
ödex
);

766 if(
	`do_mac
(
msgmode
, 0xffff, 
mychÆÀnge
,
sha256sum
))

768 
	`¥ötk
(
KERN_INFO
"Authenticated!\n");

772 if(
cou¡
++>5)

774 
	`¥ötk
(
KERN_INFO
"failed\n");

779 
	`mdñay
(900);

780 
	`PRINTK
(
KERN_INFO
"tryágain !\n ");

785 
	}
}

787 
	$í¸y_gpio_io˘l
(
fûe
 *
fûp
,
cmd
,
¨g
)

790 
	}
}

792 
	$í¸y_gpio_öô
()

794 
ªsu…
;

795 
ªsu…
=(
	`gpio_ªque°
(
GPIO_PORT_SEND
,
œbñ_£nd
));

796 if(
ªsu…
)

798 
	`¥ötk
("errÑequest!\n");

801 if(
	`gpio_dúe˘i⁄_ouçut
(
GPIO_PORT_SEND
,1Ë=-
ENOSYS
)

803 
	`¥ötk
("direction outputÉrror!\n");

807 
	}
}

815 
fûe_›î©i⁄s
 
	gí¸y_gpio_f›s
=

817 .
ow√r
 = 
THIS_MODULE
,

818 .
	gu∆ocked_io˘l
 = 
í¸y_gpio_io˘l
,

821 
__öô
 
	$Àdgpio_öô
()

823 
ªsu…
;

824 
dev_t
 
devno
;

825 if(
í¸y_gpio_MAJOR
)

827 
devno
 = 
	`MKDEV
(
í¸y_gpio_MAJOR
,0);

828 
ªsu…
=
	`ªgi°î_chrdev_ªgi⁄
(
devno
,1,
DEVICE_NAME
);

832 
ªsu…
 = 
	`Æloc_chrdev_ªgi⁄
(&
devno
,0,1,
DEVICE_NAME
);

833 
í¸y_gpio_MAJOR
 = 
	`MAJOR
(
devno
);

836 if(
ªsu…
)

838 
	`¥ötk
(
KERN_NOTICE
"Eº‹ %dÑegi°îÜedgpio",
ªsu…
);

839  
ªsu…
;

841 
	`cdev_öô
(&
cdev_í¸y_gpio
,&
í¸y_gpio_f›s
);

842 
ªsu…
 = 
	`cdev_add
(&
cdev_í¸y_gpio
,
devno
,1);

843 if(
ªsu…
)

845 
	`¥ötk
(
KERN_NOTICE
"Eº‹ %dá dög sig«l_gpio",
ªsu…
);

846  
ªsu…
;

848 
˛ass_í¸y_gpio
 = 
	`˛ass_¸óã
(
THIS_MODULE
,"class_encry_gpio");

850 
	`devi˚_¸óã
(
˛ass_í¸y_gpio
,
NULL
,
	`MKDEV
(
í¸y_gpio_MAJOR
,0),"NULL",
DEVICE_NAME
);

854 if(!
	`í¸y_gpio_öô
())

856 
	`¥ötk
(
KERN_NOTICE
"single_gpio_initÉrror!\n");

861 if(
	`ã°_do_auth
()) 0;

863 
	}
}

866 
__exô
 
	$Àdgpio_exô
()

868 
	`cdev_dñ
(&
cdev_í¸y_gpio
);

870 
	`uƒegi°î_chrdev_ªgi⁄
(
	`MKDEV
(
í¸y_gpio_MAJOR
,0),1);

871 
	`devi˚_de°roy
(
˛ass_í¸y_gpio
,
	`MKDEV
(
í¸y_gpio_MAJOR
,0));

873 
	`˛ass_de°roy
(
˛ass_í¸y_gpio
);

876 
	`gpio_‰ì
(
GPIO_PORT_SEND
);

877 
	}
}

879 
c‹e_öôˇŒ
(
Àdgpio_öô
);

883 
MODULE_LICENSE
("GPL");

884 
MODULE_AUTHOR
("SHIZHAI");

	@/usr/include/linux/fs.h

1 #i‚de‡
_LINUX_FS_H


2 
	#_LINUX_FS_H


	)

9 
	~<löux/limôs.h
>

10 
	~<löux/io˘l.h
>

11 
	~<löux/blk_ty≥s.h
>

12 
	~<löux/ty≥s.h
>

25 #unde‡
NR_OPEN


26 
	#INR_OPEN_CUR
 1024

	)

27 
	#INR_OPEN_MAX
 4096

	)

29 
	#BLOCK_SIZE_BITS
 10

	)

30 
	#BLOCK_SIZE
 (1<<
BLOCK_SIZE_BITS
)

	)

32 
	#SEEK_SET
 0

	)

33 
	#SEEK_CUR
 1

	)

34 
	#SEEK_END
 2

	)

35 
	#SEEK_DATA
 3

	)

36 
	#SEEK_HOLE
 4

	)

37 
	#SEEK_MAX
 
SEEK_HOLE


	)

39 
	sf°rim_ønge
 {

40 
__u64
 
	m°¨t
;

41 
__u64
 
	mÀn
;

42 
__u64
 
	mmöÀn
;

46 
	sfûes_°©_°ru˘
 {

47 
	mƒ_fûes
;

48 
	mƒ_‰ì_fûes
;

49 
	mmax_fûes
;

52 
	söodes_°©_t
 {

53 
	mƒ_öodes
;

54 
	mƒ_unu£d
;

55 
	mdummy
[5];

59 
	#NR_FILE
 8192

	)

61 
	#MAY_EXEC
 0x00000001

	)

62 
	#MAY_WRITE
 0x00000002

	)

63 
	#MAY_READ
 0x00000004

	)

64 
	#MAY_APPEND
 0x00000008

	)

65 
	#MAY_ACCESS
 0x00000010

	)

66 
	#MAY_OPEN
 0x00000020

	)

67 
	#MAY_CHDIR
 0x00000040

	)

69 
	#MAY_NOT_BLOCK
 0x00000080

	)

77 
	#FMODE_READ
 ((
fmode_t
)0x1)

	)

79 
	#FMODE_WRITE
 ((
fmode_t
)0x2)

	)

81 
	#FMODE_LSEEK
 ((
fmode_t
)0x4)

	)

83 
	#FMODE_PREAD
 ((
fmode_t
)0x8)

	)

85 
	#FMODE_PWRITE
 ((
fmode_t
)0x10)

	)

87 
	#FMODE_EXEC
 ((
fmode_t
)0x20)

	)

89 
	#FMODE_NDELAY
 ((
fmode_t
)0x40)

	)

91 
	#FMODE_EXCL
 ((
fmode_t
)0x80)

	)

94 
	#FMODE_WRITE_IOCTL
 ((
fmode_t
)0x100)

	)

96 
	#FMODE_32BITHASH
 ((
fmode_t
)0x200)

	)

98 
	#FMODE_64BITHASH
 ((
fmode_t
)0x400)

	)

106 
	#FMODE_NOCMTIME
 ((
fmode_t
)0x800)

	)

109 
	#FMODE_RANDOM
 ((
fmode_t
)0x1000)

	)

112 
	#FMODE_UNSIGNED_OFFSET
 ((
fmode_t
)0x2000)

	)

115 
	#FMODE_PATH
 ((
fmode_t
)0x4000)

	)

118 
	#FMODE_NONOTIFY
 ((
fmode_t
)0x1000000)

	)

162 
	#RW_MASK
 
REQ_WRITE


	)

163 
	#RWA_MASK
 
REQ_RAHEAD


	)

165 
	#READ
 0

	)

166 
	#WRITE
 
RW_MASK


	)

167 
	#READA
 
RWA_MASK


	)

169 
	#READ_SYNC
 (
READ
 | 
REQ_SYNC
)

	)

170 
	#WRITE_SYNC
 (
WRITE
 | 
REQ_SYNC
 | 
REQ_NOIDLE
)

	)

171 
	#WRITE_ODIRECT
 (
WRITE
 | 
REQ_SYNC
)

	)

172 
	#WRITE_FLUSH
 (
WRITE
 | 
REQ_SYNC
 | 
REQ_NOIDLE
 | 
REQ_FLUSH
)

	)

173 
	#WRITE_FUA
 (
WRITE
 | 
REQ_SYNC
 | 
REQ_NOIDLE
 | 
REQ_FUA
)

	)

174 
	#WRITE_FLUSH_FUA
 (
WRITE
 | 
REQ_SYNC
 | 
REQ_NOIDLE
 | 
REQ_FLUSH
 | 
REQ_FUA
)

	)

176 
	#SEL_IN
 1

	)

177 
	#SEL_OUT
 2

	)

178 
	#SEL_EX
 4

	)

181 
	#FS_REQUIRES_DEV
 1

	)

182 
	#FS_BINARY_MOUNTDATA
 2

	)

183 
	#FS_HAS_SUBTYPE
 4

	)

184 
	#FS_REVAL_DOT
 16384

	)

185 
	#FS_RENAME_DOES_D_MOVE
 32768

	)

192 
	#MS_RDONLY
 1

	)

193 
	#MS_NOSUID
 2

	)

194 
	#MS_NODEV
 4

	)

195 
	#MS_NOEXEC
 8

	)

196 
	#MS_SYNCHRONOUS
 16

	)

197 
	#MS_REMOUNT
 32

	)

198 
	#MS_MANDLOCK
 64

	)

199 
	#MS_DIRSYNC
 128

	)

200 
	#MS_NOATIME
 1024

	)

201 
	#MS_NODIRATIME
 2048

	)

202 
	#MS_BIND
 4096

	)

203 
	#MS_MOVE
 8192

	)

204 
	#MS_REC
 16384

	)

205 
	#MS_VERBOSE
 32768

	)

207 
	#MS_SILENT
 32768

	)

208 
	#MS_POSIXACL
 (1<<16Ë

	)

209 
	#MS_UNBINDABLE
 (1<<17Ë

	)

210 
	#MS_PRIVATE
 (1<<18Ë

	)

211 
	#MS_SLAVE
 (1<<19Ë

	)

212 
	#MS_SHARED
 (1<<20Ë

	)

213 
	#MS_RELATIME
 (1<<21Ë

	)

214 
	#MS_KERNMOUNT
 (1<<22Ë

	)

215 
	#MS_I_VERSION
 (1<<23Ë

	)

216 
	#MS_STRICTATIME
 (1<<24Ë

	)

217 
	#MS_NOSEC
 (1<<28)

	)

218 
	#MS_BORN
 (1<<29)

	)

219 
	#MS_ACTIVE
 (1<<30)

	)

220 
	#MS_NOUSER
 (1<<31)

	)

225 
	#MS_RMT_MASK
 (
MS_RDONLY
|
MS_SYNCHRONOUS
|
MS_MANDLOCK
|
MS_I_VERSION
)

	)

230 
	#MS_MGC_VAL
 0xC0ED0000

	)

231 
	#MS_MGC_MSK
 0xffff0000

	)

235 
	#S_SYNC
 1

	)

236 
	#S_NOATIME
 2

	)

237 
	#S_APPEND
 4

	)

238 
	#S_IMMUTABLE
 8

	)

239 
	#S_DEAD
 16

	)

240 
	#S_NOQUOTA
 32

	)

241 
	#S_DIRSYNC
 64

	)

242 
	#S_NOCMTIME
 128

	)

243 
	#S_SWAPFILE
 256

	)

244 
	#S_PRIVATE
 512

	)

245 
	#S_IMA
 1024

	)

246 
	#S_AUTOMOUNT
 2048

	)

247 
	#S_NOSEC
 4096

	)

262 
	#__IS_FLG
(
öode
,
Êg
Ë((öode)->
i_sb
->
s_Êags
 & (Êg))

	)

264 
	#IS_RDONLY
(
öode
Ë((öode)->
i_sb
->
s_Êags
 & 
MS_RDONLY
)

	)

265 
	#IS_SYNC
(
öode
Ë(
	`__IS_FLG
(öode, 
MS_SYNCHRONOUS
) || \

266 ((
öode
)->
i_Êags
 & 
S_SYNC
))

	)

267 
	#IS_DIRSYNC
(
öode
Ë(
	`__IS_FLG
(öode, 
MS_SYNCHRONOUS
|
MS_DIRSYNC
) || \

268 ((
öode
)->
i_Êags
 & (
S_SYNC
|
S_DIRSYNC
)))

	)

269 
	#IS_MANDLOCK
(
öode
Ë
	`__IS_FLG
(öode, 
MS_MANDLOCK
)

	)

270 
	#IS_NOATIME
(
öode
Ë
	`__IS_FLG
(öode, 
MS_RDONLY
|
MS_NOATIME
)

	)

271 
	#IS_I_VERSION
(
öode
Ë
	`__IS_FLG
(öode, 
MS_I_VERSION
)

	)

273 
	#IS_NOQUOTA
(
öode
Ë((öode)->
i_Êags
 & 
S_NOQUOTA
)

	)

274 
	#IS_APPEND
(
öode
Ë((öode)->
i_Êags
 & 
S_APPEND
)

	)

275 
	#IS_IMMUTABLE
(
öode
Ë((öode)->
i_Êags
 & 
S_IMMUTABLE
)

	)

276 
	#IS_POSIXACL
(
öode
Ë
	`__IS_FLG
(öode, 
MS_POSIXACL
)

	)

278 
	#IS_DEADDIR
(
öode
Ë((öode)->
i_Êags
 & 
S_DEAD
)

	)

279 
	#IS_NOCMTIME
(
öode
Ë((öode)->
i_Êags
 & 
S_NOCMTIME
)

	)

280 
	#IS_SWAPFILE
(
öode
Ë((öode)->
i_Êags
 & 
S_SWAPFILE
)

	)

281 
	#IS_PRIVATE
(
öode
Ë((öode)->
i_Êags
 & 
S_PRIVATE
)

	)

282 
	#IS_IMA
(
öode
Ë((öode)->
i_Êags
 & 
S_IMA
)

	)

283 
	#IS_AUTOMOUNT
(
öode
Ë((öode)->
i_Êags
 & 
S_AUTOMOUNT
)

	)

284 
	#IS_NOSEC
(
öode
Ë((öode)->
i_Êags
 & 
S_NOSEC
)

	)

289 
	#BLKROSET
 
	`_IO
(0x12,93Ë

	)

290 
	#BLKROGET
 
	`_IO
(0x12,94Ë

	)

291 
	#BLKRRPART
 
	`_IO
(0x12,95Ë

	)

292 
	#BLKGETSIZE
 
	`_IO
(0x12,96Ë

	)

293 
	#BLKFLSBUF
 
	`_IO
(0x12,97Ë

	)

294 
	#BLKRASET
 
	`_IO
(0x12,98Ë

	)

295 
	#BLKRAGET
 
	`_IO
(0x12,99Ë

	)

296 
	#BLKFRASET
 
	`_IO
(0x12,100)

	)

297 
	#BLKFRAGET
 
	`_IO
(0x12,101)

	)

298 
	#BLKSECTSET
 
	`_IO
(0x12,102)

	)

299 
	#BLKSECTGET
 
	`_IO
(0x12,103)

	)

300 
	#BLKSSZGET
 
	`_IO
(0x12,104)

	)

302 
	#BLKPG
 
	`_IO
(0x12,105)

	)

306 
	#BLKELVGET
 
	`_IOR
(0x12,106,
size_t
)

	)

307 
	#BLKELVSET
 
	`_IOW
(0x12,107,
size_t
)

	)

312 
	#BLKBSZGET
 
	`_IOR
(0x12,112,
size_t
)

	)

313 
	#BLKBSZSET
 
	`_IOW
(0x12,113,
size_t
)

	)

314 
	#BLKGETSIZE64
 
	`_IOR
(0x12,114,
size_t
Ë

	)

315 
	#BLKTRACESETUP
 
	`_IOWR
(0x12,115,
blk_u£r_åa˚_£tup
)

	)

316 
	#BLKTRACESTART
 
	`_IO
(0x12,116)

	)

317 
	#BLKTRACESTOP
 
	`_IO
(0x12,117)

	)

318 
	#BLKTRACETEARDOWN
 
	`_IO
(0x12,118)

	)

319 
	#BLKDISCARD
 
	`_IO
(0x12,119)

	)

320 
	#BLKIOMIN
 
	`_IO
(0x12,120)

	)

321 
	#BLKIOOPT
 
	`_IO
(0x12,121)

	)

322 
	#BLKALIGNOFF
 
	`_IO
(0x12,122)

	)

323 
	#BLKPBSZGET
 
	`_IO
(0x12,123)

	)

324 
	#BLKDISCARDZEROES
 
	`_IO
(0x12,124)

	)

325 
	#BLKSECDISCARD
 
	`_IO
(0x12,125)

	)

327 
	#BMAP_IOCTL
 1

	)

328 
	#FIBMAP
 
	`_IO
(0x00,1Ë

	)

329 
	#FIGETBSZ
 
	`_IO
(0x00,2Ë

	)

330 
	#FIFREEZE
 
	`_IOWR
('X', 119, Ë

	)

331 
	#FITHAW
 
	`_IOWR
('X', 120, Ë

	)

332 
	#FITRIM
 
	`_IOWR
('X', 121, 
f°rim_ønge
Ë

	)

334 
	#FS_IOC_GETFLAGS
 
	`_IOR
('f', 1, )

	)

335 
	#FS_IOC_SETFLAGS
 
	`_IOW
('f', 2, )

	)

336 
	#FS_IOC_GETVERSION
 
	`_IOR
('v', 1, )

	)

337 
	#FS_IOC_SETVERSION
 
	`_IOW
('v', 2, )

	)

338 
	#FS_IOC_FIEMAP
 
	`_IOWR
('f', 11, 
fõm≠
)

	)

339 
	#FS_IOC32_GETFLAGS
 
	`_IOR
('f', 1, )

	)

340 
	#FS_IOC32_SETFLAGS
 
	`_IOW
('f', 2, )

	)

341 
	#FS_IOC32_GETVERSION
 
	`_IOR
('v', 1, )

	)

342 
	#FS_IOC32_SETVERSION
 
	`_IOW
('v', 2, )

	)

347 
	#FS_SECRM_FL
 0x00000001

	)

348 
	#FS_UNRM_FL
 0x00000002

	)

349 
	#FS_COMPR_FL
 0x00000004

	)

350 
	#FS_SYNC_FL
 0x00000008

	)

351 
	#FS_IMMUTABLE_FL
 0x00000010

	)

352 
	#FS_APPEND_FL
 0x00000020

	)

353 
	#FS_NODUMP_FL
 0x00000040

	)

354 
	#FS_NOATIME_FL
 0x00000080

	)

356 
	#FS_DIRTY_FL
 0x00000100

	)

357 
	#FS_COMPRBLK_FL
 0x00000200

	)

358 
	#FS_NOCOMP_FL
 0x00000400

	)

359 
	#FS_ECOMPR_FL
 0x00000800

	)

361 
	#FS_BTREE_FL
 0x00001000

	)

362 
	#FS_INDEX_FL
 0x00001000

	)

363 
	#FS_IMAGIC_FL
 0x00002000

	)

364 
	#FS_JOURNAL_DATA_FL
 0x00004000

	)

365 
	#FS_NOTAIL_FL
 0x00008000

	)

366 
	#FS_DIRSYNC_FL
 0x00010000

	)

367 
	#FS_TOPDIR_FL
 0x00020000

	)

368 
	#FS_EXTENT_FL
 0x00080000

	)

369 
	#FS_DIRECTIO_FL
 0x00100000

	)

370 
	#FS_NOCOW_FL
 0x00800000

	)

371 
	#FS_RESERVED_FL
 0x80000000

	)

373 
	#FS_FL_USER_VISIBLE
 0x0003DFFF

	)

374 
	#FS_FL_USER_MODIFIABLE
 0x000380FF

	)

377 
	#SYNC_FILE_RANGE_WAIT_BEFORE
 1

	)

378 
	#SYNC_FILE_RANGE_WRITE
 2

	)

379 
	#SYNC_FILE_RANGE_WAIT_AFTER
 4

	)

	@/usr/include/linux/kernel.h

1 #i‚de‡
_LINUX_KERNEL_H


2 
	#_LINUX_KERNEL_H


	)

7 
	#__ALIGN_KERNEL
(
x
, 
a
Ë
	`__ALIGN_KERNEL_MASK
(x, (
	`ty≥of
(x))◊Ë- 1)

	)

8 
	#__ALIGN_KERNEL_MASK
(
x
, 
mask
Ë(((xË+ (mask)Ë& ~(mask))

	)

11 
	#SI_LOAD_SHIFT
 16

	)

12 
	ssysöfo
 {

13 
	mu±ime
;

14 
	mlﬂds
[3];

15 
	mtŸÆøm
;

16 
	m‰ìøm
;

17 
	msh¨edøm
;

18 
	mbuf„ºam
;

19 
	mtŸÆsw≠
;

20 
	m‰ìsw≠
;

21 
	m¥ocs
;

22 
	m∑d
;

23 
	mtŸÆhigh
;

24 
	m‰ìhigh
;

25 
	mmem_unô
;

26 
	m_f
[20-2*()-()];

	@/usr/include/linux/random.h

7 #i‚de‡
_LINUX_RANDOM_H


8 
	#_LINUX_RANDOM_H


	)

10 
	~<löux/ty≥s.h
>

11 
	~<löux/io˘l.h
>

12 
	~<löux/úqƒ.h
>

17 
	#RNDGETENTCNT
 
	`_IOR
–'R', 0x00, )

	)

20 
	#RNDADDTOENTCNT
 
	`_IOW
–'R', 0x01, )

	)

23 
	#RNDGETPOOL
 
	`_IOR
–'R', 0x02, [2] )

	)

29 
	#RNDADDENTROPY
 
	`_IOW
–'R', 0x03, [2] )

	)

32 
	#RNDZAPENTCNT
 
	`_IO
–'R', 0x04 )

	)

35 
	#RNDCLEARPOOL
 
	`_IO
–'R', 0x06 )

	)

37 
	sønd_poﬁ_öfo
 {

38 
	míå›y_cou¡
;

39 
	mbuf_size
;

40 
__u32
 
	mbuf
[0];

43 
	s∫d_°©e
 {

44 
__u32
 
	ms1
, 
	ms2
, 
	ms3
;

	@/usr/include/linux/types.h

1 #i‚de‡
_LINUX_TYPES_H


2 
	#_LINUX_TYPES_H


	)

4 
	~<asm/ty≥s.h
>

6 #i‚de‡
__ASSEMBLY__


8 
	~<löux/posix_ty≥s.h
>

16 #ifde‡
__CHECKER__


17 
	#__bôwi£__
 
	`__©åibuã__
((
bôwi£
))

	)

19 
	#__bôwi£__


	)

21 #ifde‡
__CHECK_ENDIAN__


22 
	#__bôwi£
 
__bôwi£__


	)

24 
	#__bôwi£


	)

27 
__u16
 
	t__bôwi£
 
	t__À16
;

28 
__u16
 
	t__bôwi£
 
	t__be16
;

29 
__u32
 
	t__bôwi£
 
	t__À32
;

30 
__u32
 
	t__bôwi£
 
	t__be32
;

31 
__u64
 
	t__bôwi£
 
	t__À64
;

32 
__u64
 
	t__bôwi£
 
	t__be64
;

34 
__u16
 
	t__bôwi£
 
	t__sum16
;

35 
__u32
 
	t__bôwi£
 
	t__wsum
;

46 
	#__Æig√d_u64
 
__u64
 
	`__©åibuã__
((
	`Æig√d
(8)))

	)

47 
	#__Æig√d_be64
 
__be64
 
	`__©åibuã__
((
	`Æig√d
(8)))

	)

48 
	#__Æig√d_À64
 
__À64
 
	`__©åibuã__
((
	`Æig√d
(8)))

	)

	@/usr/include/linux/blk_types.h

5 #i‚de‡
__LINUX_BLK_TYPES_H


6 
	#__LINUX_BLK_TYPES_H


	)

8 #ifde‡
CONFIG_BLOCK


10 
	~<löux/ty≥s.h
>

12 
	gbio_£t
;

13 
	gbio
;

14 
	gbio_öãgrôy_∑ylﬂd
;

15 
	g∑ge
;

16 
	gblock_devi˚
;

17 (
	tbio_íd_io_t
Ë(
	tbio
 *, );

18 (
	tbio_de°ru˘‹_t
Ë(
	tbio
 *);

23 
	sbio_vec
 {

24 
∑ge
 *
bv_∑ge
;

25 
bv_Àn
;

26 
bv_off£t
;

33 
	sbio
 {

34 
£˘‹_t
 
bi_£˘‹
;

36 
bio
 *
bi_√xt
;

37 
block_devi˚
 *
bi_bdev
;

38 
bi_Êags
;

39 
bi_rw
;

43 
bi_v˙t
;

44 
bi_idx
;

49 
bi_phys_£gmíts
;

51 
bi_size
;

57 
bi_£g_‰⁄t_size
;

58 
bi_£g_back_size
;

60 
bi_max_vecs
;

62 
©omic_t
 
bi_˙t
;

64 
bio_vec
 *
bi_io_vec
;

66 
bio_íd_io_t
 *
bi_íd_io
;

68 *
bi_¥iv©e
;

69 #i‡
	`deföed
(
CONFIG_BLK_DEV_INTEGRITY
)

70 
bio_öãgrôy_∑ylﬂd
 *
bi_öãgrôy
;

73 
bio_de°ru˘‹_t
 *
bi_de°ru˘‹
;

80 
bio_vec
 
bi_ölöe_vecs
[0];

86 
	#BIO_UPTODATE
 0

	)

87 
	#BIO_RW_BLOCK
 1

	)

88 
	#BIO_EOF
 2

	)

89 
	#BIO_SEG_VALID
 3

	)

90 
	#BIO_CLONED
 4

	)

91 
	#BIO_BOUNCED
 5

	)

92 
	#BIO_USER_MAPPED
 6

	)

93 
	#BIO_EOPNOTSUPP
 7

	)

94 
	#BIO_NULL_MAPPED
 8

	)

95 
	#BIO_FS_INTEGRITY
 9

	)

96 
	#BIO_QUIET
 10

	)

97 
	#BIO_MAPPED_INTEGRITY
 11

	)

98 
	#bio_Êagged
(
bio
, 
Êag
Ë((bio)->
bi_Êags
 & (1 << (Êag)))

	)

103 
	#BIO_POOL_BITS
 (4)

	)

104 
	#BIO_POOL_NONE
 ((1UL << 
BIO_POOL_BITS
Ë- 1)

	)

105 
	#BIO_POOL_OFFSET
 (
BITS_PER_LONG
 - 
BIO_POOL_BITS
)

	)

106 
	#BIO_POOL_MASK
 (1UL << 
BIO_POOL_OFFSET
)

	)

107 
	#BIO_POOL_IDX
(
bio
Ë((bio)->
bi_Êags
 >> 
BIO_POOL_OFFSET
)

	)

115 
	erq_Êag_bôs
 {

117 
__REQ_WRITE
,

118 
__REQ_FAILFAST_DEV
,

119 
__REQ_FAILFAST_TRANSPORT
,

120 
__REQ_FAILFAST_DRIVER
,

122 
__REQ_SYNC
,

123 
__REQ_META
,

124 
__REQ_PRIO
,

125 
__REQ_DISCARD
,

126 
__REQ_SECURE
,

128 
__REQ_NOIDLE
,

129 
__REQ_FUA
,

130 
__REQ_FLUSH
,

133 
__REQ_RAHEAD
,

134 
__REQ_THROTTLED
,

138 
__REQ_SORTED
,

139 
__REQ_SOFTBARRIER
,

140 
__REQ_NOMERGE
,

141 
__REQ_STARTED
,

142 
__REQ_DONTPREP
,

143 
__REQ_QUEUED
,

144 
__REQ_ELVPRIV
,

145 
__REQ_FAILED
,

146 
__REQ_QUIET
,

147 
__REQ_PREEMPT
,

148 
__REQ_ALLOCED
,

149 
__REQ_COPY_USER
,

150 
__REQ_FLUSH_SEQ
,

151 
__REQ_IO_STAT
,

152 
__REQ_MIXED_MERGE
,

153 
__REQ_NR_BITS
,

156 
	#REQ_WRITE
 (1 << 
__REQ_WRITE
)

	)

157 
	#REQ_FAILFAST_DEV
 (1 << 
__REQ_FAILFAST_DEV
)

	)

158 
	#REQ_FAILFAST_TRANSPORT
 (1 << 
__REQ_FAILFAST_TRANSPORT
)

	)

159 
	#REQ_FAILFAST_DRIVER
 (1 << 
__REQ_FAILFAST_DRIVER
)

	)

160 
	#REQ_SYNC
 (1 << 
__REQ_SYNC
)

	)

161 
	#REQ_META
 (1 << 
__REQ_META
)

	)

162 
	#REQ_PRIO
 (1 << 
__REQ_PRIO
)

	)

163 
	#REQ_DISCARD
 (1 << 
__REQ_DISCARD
)

	)

164 
	#REQ_NOIDLE
 (1 << 
__REQ_NOIDLE
)

	)

166 
	#REQ_FAILFAST_MASK
 \

167 (
REQ_FAILFAST_DEV
 | 
REQ_FAILFAST_TRANSPORT
 | 
REQ_FAILFAST_DRIVER
)

	)

168 
	#REQ_COMMON_MASK
 \

169 (
REQ_WRITE
 | 
REQ_FAILFAST_MASK
 | 
REQ_SYNC
 | 
REQ_META
 | 
REQ_PRIO
 | \

170 
REQ_DISCARD
 | 
REQ_NOIDLE
 | 
REQ_FLUSH
 | 
REQ_FUA
 | 
REQ_SECURE
)

	)

171 
	#REQ_CLONE_MASK
 
REQ_COMMON_MASK


	)

173 
	#REQ_RAHEAD
 (1 << 
__REQ_RAHEAD
)

	)

174 
	#REQ_THROTTLED
 (1 << 
__REQ_THROTTLED
)

	)

176 
	#REQ_SORTED
 (1 << 
__REQ_SORTED
)

	)

177 
	#REQ_SOFTBARRIER
 (1 << 
__REQ_SOFTBARRIER
)

	)

178 
	#REQ_FUA
 (1 << 
__REQ_FUA
)

	)

179 
	#REQ_NOMERGE
 (1 << 
__REQ_NOMERGE
)

	)

180 
	#REQ_STARTED
 (1 << 
__REQ_STARTED
)

	)

181 
	#REQ_DONTPREP
 (1 << 
__REQ_DONTPREP
)

	)

182 
	#REQ_QUEUED
 (1 << 
__REQ_QUEUED
)

	)

183 
	#REQ_ELVPRIV
 (1 << 
__REQ_ELVPRIV
)

	)

184 
	#REQ_FAILED
 (1 << 
__REQ_FAILED
)

	)

185 
	#REQ_QUIET
 (1 << 
__REQ_QUIET
)

	)

186 
	#REQ_PREEMPT
 (1 << 
__REQ_PREEMPT
)

	)

187 
	#REQ_ALLOCED
 (1 << 
__REQ_ALLOCED
)

	)

188 
	#REQ_COPY_USER
 (1 << 
__REQ_COPY_USER
)

	)

189 
	#REQ_FLUSH
 (1 << 
__REQ_FLUSH
)

	)

190 
	#REQ_FLUSH_SEQ
 (1 << 
__REQ_FLUSH_SEQ
)

	)

191 
	#REQ_IO_STAT
 (1 << 
__REQ_IO_STAT
)

	)

192 
	#REQ_MIXED_MERGE
 (1 << 
__REQ_MIXED_MERGE
)

	)

193 
	#REQ_SECURE
 (1 << 
__REQ_SECURE
)

	)

	@/usr/include/linux/ioctl.h

1 #i‚de‡
_LINUX_IOCTL_H


2 
	#_LINUX_IOCTL_H


	)

4 
	~<asm/io˘l.h
>

	@/usr/include/linux/irqnr.h

1 #i‚de‡
_LINUX_IRQNR_H


2 
	#_LINUX_IRQNR_H


	)

	@/usr/include/linux/limits.h

1 #i‚de‡
_LINUX_LIMITS_H


2 
	#_LINUX_LIMITS_H


	)

4 
	#NR_OPEN
 1024

	)

6 
	#NGROUPS_MAX
 65536

	)

7 
	#ARG_MAX
 131072

	)

8 
	#LINK_MAX
 127

	)

9 
	#MAX_CANON
 255

	)

10 
	#MAX_INPUT
 255

	)

11 
	#NAME_MAX
 255

	)

12 
	#PATH_MAX
 4096

	)

13 
	#PIPE_BUF
 4096

	)

14 
	#XATTR_NAME_MAX
 255

	)

15 
	#XATTR_SIZE_MAX
 65536

	)

16 
	#XATTR_LIST_MAX
 65536

	)

18 
	#RTSIG_MAX
 32

	)

	@/usr/include/linux/posix_types.h

1 #i‚de‡
_LINUX_POSIX_TYPES_H


2 
	#_LINUX_POSIX_TYPES_H


	)

4 
	~<löux/°ddef.h
>

21 #unde‡
__NFDBITS


22 
	#__NFDBITS
 (8 * ())

	)

24 #unde‡
__FD_SETSIZE


25 
	#__FD_SETSIZE
 1024

	)

27 #unde‡
__FDSET_LONGS


28 
	#__FDSET_LONGS
 (
__FD_SETSIZE
/
__NFDBITS
)

	)

30 #unde‡
__FDELT


31 
	#__FDELT
(
d
Ë((dË/ 
__NFDBITS
)

	)

33 #unde‡
__FDMASK


34 
	#__FDMASK
(
d
Ë(1UL << ((dË% 
__NFDBITS
))

	)

37 
	mfds_bôs
 [
__FDSET_LONGS
];

38 } 
	t__kî√l_fd_£t
;

41 (*
	t__kî√l_sigh™dÀr_t
)();

44 
	t__kî√l_key_t
;

45 
	t__kî√l_mqd_t
;

47 
	~<asm/posix_ty≥s.h
>

	@/usr/include/linux/stddef.h

1 #i‚de‡
_LINUX_STDDEF_H


2 
	#_LINUX_STDDEF_H


	)

6 #unde‡
NULL


7 #i‡
deföed
(
__˝lu•lus
)

8 
	#NULL
 0

	)

10 
	#NULL
 ((*)0)

	)

	@
1
.
1
/usr/include
12
301
sha256.h
zw_encry.c
/usr/include/linux/fs.h
/usr/include/linux/kernel.h
/usr/include/linux/random.h
/usr/include/linux/types.h
/usr/include/linux/blk_types.h
/usr/include/linux/ioctl.h
/usr/include/linux/irqnr.h
/usr/include/linux/limits.h
/usr/include/linux/posix_types.h
/usr/include/linux/stddef.h
